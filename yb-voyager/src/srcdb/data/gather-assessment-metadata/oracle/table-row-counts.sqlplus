SET ECHO OFF
SET FEEDBACK OFF
SET HEADING ON
SET MARKUP CSV ON DELIMITER , QUOTE OFF
SET PAGESIZE 0
SET TRIMSPOOL ON
SET TERMOUT OFF
SET VERIFY OFF

-- Exit on SQL errors or OS errors
WHENEVER SQLERROR EXIT SQL.SQLCODE
WHENEVER OSERROR EXIT FAILURE

-- Select the data into the CSV file using inline views
SPOOL table-row-counts.csv
SELECT
    distinct(t.owner) AS schema_name, t.table_name,
    0 as row_count
  FROM
    dba_tables t
  WHERE 
    t.owner = '&1';
SPOOL OFF

EXIT;